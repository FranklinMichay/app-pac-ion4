<ion-header>
    <ion-toolbar color="primary">
        <ion-back-button class="title-toolbar" slot="start">
        </ion-back-button>
        <ion-buttons slot="end">
            <ion-button (click)="returnHome()" slot="end">
                <ion-icon class="style-icon-logout" slot="icon-only" name="home"></ion-icon>
            </ion-button>
        </ion-buttons>
        <ion-title class="title-toolbar">RECETAS</ion-title>
    </ion-toolbar>
</ion-header>
<div>
    <div class="ion-padding div-menu">
        <ion-row class="nav-tabs">
            <ion-col class="col-left" [ngClass]="{'active': currentTab === 'step1'}" (click)="changeTab('step1')">
                <label class="text-center">Por ordenar</label>
            </ion-col>
            <ion-col class="col-center" [ngClass]="{'active': currentTab === 'step2'}" (click)="changeTab('step2')">
                <label class="text-center">Compradas</label>
            </ion-col>
            <ion-col class="col-right" [ngClass]="{'active': currentTab === 'step3'}" (click)="changeTab('step3')">
                <label class="text-center">Historial</label>
            </ion-col>
        </ion-row>
    </div>
</div>

<div class="title-data" *ngIf="currentTab === 'step2'">
    <ion-label class="medicamentos">Ordenes Pendientes</ion-label>
</div>

<ion-content>
    <div class="form-group required" *ngIf="currentTab === 'step1'">
        <div *ngIf="newAppointment">
            <ion-grid class="content-medic">
                <ion-row *ngFor="let appointment of newAppointment" (click)="prepareIdsRequest(appointment)" class="container-medic">
                    <ion-col class="container-image" size="2">
                        <img class="image" src="assets/icon/receta.svg " />
                    </ion-col>
                    <ion-col class="container-info-medic " size="9">
                        <ion-row>
                            <ion-col class="name" size="8">
                                DR: {{ appointment.datosMed.priNombre | uppercase}} {{ appointment.datosMed.priApellido | uppercase}}
                            </ion-col>
                            <ion-col class="codReceta" size="4">
                                COD#:{{ appointment.codiRece }}
                            </ion-col>
                        </ion-row>
                        <ion-row>
                            <ion-col class="fecha" size="12">
                                {{ appointment.fecha | date: 'dd MMM y' | titlecase}}
                            </ion-col>
                        </ion-row>
                        <ion-row>
                            <ion-col class="cm" size="12">
                                {{ appointment.datosMed.especialidad}}
                            </ion-col>
                        </ion-row>
                    </ion-col>
                    <ion-col size="1" class="icon-medic">
                        <ion-icon name="ios-arrow-forward"></ion-icon>
                    </ion-col>
                </ion-row>
            </ion-grid>
            <div *ngIf="newAppointment.length === 0" class="empty-container ">
                <img src="assets/icon/no-documents.svg" class="empty-state ">
                <h3 class="text-center-no-desp">No hay recetas nuevas</h3>
            </div>
        </div>
    </div>

    <div class="form-group required" *ngIf="currentTab === 'step2'">
        <ion-grid class="content-medic">
            <div *ngFor="let desp of despachos">
                <ion-row *ngIf="desp.estadoDespacho === 'nuevo'" (click)="prepareIdsDesp(desp)" class="container-medic">
                    <ion-col class="container-image" size="2">
                        <img class="image " src="assets/icon/receta.svg " />
                    </ion-col>
                    <ion-col class="container-info-medic " size="9">
                        <ion-row>
                            <ion-col class="name" size="8">
                                DR: {{ desp.datosReceta.datosMedico.priNombre | uppercase}} {{ desp.datosReceta.datosMedico.priApellido | uppercase}}
                            </ion-col>
                            <ion-col class="codReceta" size="4">
                                COD#:{{ desp.datosReceta.codiRece }}
                            </ion-col>
                        </ion-row>
                        <ion-row>
                            <ion-col class="fecha" size="12">
                                {{ desp.fecha | date: 'dd MMM y' | titlecase}}
                            </ion-col>
                        </ion-row>
                        <ion-row>
                            <ion-col class="cm" size="8">
                                {{ desp.datosReceta.datosMedico.especialidad}}
                            </ion-col>
                            <ion-col size="4">
                                <ion-label class="label-state" [color]="getColor(desp.estadoDespacho)">
                                    {{ desp.estadoDespacho}}</ion-label>
                            </ion-col>
                        </ion-row>
                    </ion-col>
                    <ion-col size="1" class="icon-medic">
                        <ion-icon name="ios-arrow-forward"></ion-icon>
                    </ion-col>
                </ion-row>
            </div>
        </ion-grid>
        <div *ngIf="despachos.length === 0" class="empty-container ">
            <img src="assets/icon/no-documents.svg" class="empty-state ">
            <h3 class="text-center-no-desp">No hay Ã³rdenes pendientes</h3>
        </div>
    </div>

    <div class="form-group required" *ngIf="currentTab === 'step3'" class="bg-sliding">
        <ion-item-group *ngFor="let item of dateDivider">
            <ion-item-divider sticky class="item-divider">
                <ion-label class="date-hist">{{item| date: 'dd MMM y' | titlecase}}</ion-label>
            </ion-item-divider>

            <div *ngFor="let item2 of despachos">

                <div *ngIf="item == item2.fecha">
                    <ion-row *ngIf="item2.estadoDespacho !== 'nuevo'" (click)="prepareIdsDesp(item2)" class="container-medic">
                        <ion-col class="container-image " size="2 ">
                            <img class="image " src="assets/icon/receta.svg " />
                        </ion-col>
                        <ion-col class="container-info-medic " size="9 ">
                            <ion-row>
                                <ion-col class="name " size="8 ">
                                    DR: {{ item2.datosReceta.datosMedico.priNombre | uppercase}} {{ item2.datosReceta.datosMedico.priApellido | uppercase}}
                                </ion-col>
                                <ion-col class="codReceta " size="4 ">
                                    COD#:{{ item2.datosReceta.codiRece }}
                                </ion-col>
                            </ion-row>
                            <ion-row>
                                <ion-col class="fecha " size="12 ">
                                    {{ item2.fecha | date: 'dd MMM y' | titlecase}}
                                </ion-col>
                            </ion-row>
                            <ion-row>
                                <ion-col class="cm " size="8">
                                    {{ item2.datosReceta.datosMedico.especialidad}}
                                </ion-col>
                                <ion-col size="4">

                                    <ion-label *ngIf="item2.estadoDespacho === 'camino' || item2.estadoDespacho === 'entregado'" class="label-state" [color]="getColor(item2.estadoDespacho)">
                                        {{ item2.estadoDespacho}}
                                    </ion-label>
                                    <ion-label *ngIf="item2.estadoDespacho === 'preparado' || item2.estadoDespacho === 'preparadoTrans'" class="label-state" [color]="getColor(item2.estadoDespacho)">
                                        despachado
                                    </ion-label>
                                </ion-col>
                            </ion-row>
                        </ion-col>
                        <ion-col size="1 " class="icon-medic">
                            <ion-icon name="ios-arrow-forward"></ion-icon>
                        </ion-col>
                    </ion-row>
                </div>

            </div>
        </ion-item-group>
    </div>
</ion-content>