<ion-header>
    <ion-toolbar color="primary">
        <ion-back-button text="ATRÁS" class="title-toolbar" slot="start">
        </ion-back-button>
        <ion-buttons slot="end">
            <ion-button slot="end">
            </ion-button>
        </ion-buttons>
        <ion-title class="ion-text-center" *ngIf="dataDespacho" class="title-toolbar"> COD#:{{ dataDespacho.datosReceta.codiRece }}</ion-title>
    </ion-toolbar>
</ion-header>

<ion-content *ngIf="productoDespacho">
    <div class="ion-padding div-menu">
        <ion-row class="nav-tabs">
            <ion-col class="col-left" [ngClass]="{'active': currentTab === 'step1'}" (click)="changeTab('step1')">
                <label class="text-center">Medicamentos</label>
            </ion-col>
            <!-- <ion-col class="col-center" [ngClass]="{'active': currentTab === 'step2'}" (click)="changeTab('step2')">
            <label class="text-center">Compradas</label>
        </ion-col> -->
            <ion-col class="col-right" [ngClass]="{'active': currentTab === 'step3'}" (click)="changeTab('step3')">
                <label class="text-center">Estado</label>
            </ion-col>
        </ion-row>
    </div>

    <ion-grid class="grid-receta">
        <ion-row>
            <ion-col size="8">
                <h4 class="titulo-receta">Dr. {{dataDespacho.datosReceta.datosMedico.priNombre}} {{dataDespacho.datosReceta.datosMedico.priApellido}}
                </h4>
            </ion-col>
            <ion-col size="4">
                <h4 class="titulo-receta">COD#:{{ dataDespacho.datosReceta.codiRece }}</h4>
            </ion-col>
        </ion-row>
        <ion-row>
            <ion-col size="12">
                <p class="subtitle-receta">{{dataDespacho.fecha | date: 'dd MMM y' | titlecase}}</p>
            </ion-col>
        </ion-row>
        <ion-row>
            <ion-col size="8">
                <p class="subtitle-receta">{{dataDespacho.datosReceta.datosMedico.especialidad }}</p>
            </ion-col>
            <ion-col size="4">
                <ion-label *ngIf="dataDespacho.estadoDespacho === 'camino' || dataDespacho.estadoDespacho === 'entregado' || dataDespacho.estadoDespacho === 'nuevo'" class="label-state" [color]="getColor(dataDespacho.estadoDespacho)">
                    {{ dataDespacho.estadoDespacho}}</ion-label>
                <ion-label *ngIf="dataDespacho.estadoDespacho === 'preparado' || dataDespacho.estadoDespacho === 'preparadoTrans'" class="label-state" [color]="getColor(dataDespacho.estadoDespacho)">
                    Preparado</ion-label>
            </ion-col>
        </ion-row>
    </ion-grid>

    <div class="form-group required" *ngIf="currentTab === 'step1'">
        <ion-grid *ngIf="dataDespacho" class="ion-no-padding">
            <ion-list-header class="title-data ">
                <ion-label class="medicamentos">Medicamentos</ion-label>
            </ion-list-header>

            <ion-row *ngFor="let product of productoDespacho; let i = index" class="row-content">
                <ion-col size="8">
                    <ion-label class="col-name">{{product?.idProducto.nombre}}</ion-label><br>
                    <ion-label class="col-forma">{{product?.idProducto.formaFarmaceutica}}</ion-label>
                </ion-col>

                <ion-col size="4" class="col-name">
                    Cant. {{ dataDespacho.datosReceta.detalles[i].cantidad | number: '1.2-4'}}
                </ion-col>

                <ion-col size="12">
                    <hr class="line"><br>
                    <ion-label class="col-ind">Indicaciones:</ion-label><br>
                    <ion-label class="col-ind-text">{{dataDespacho.datosReceta.indicaciones[i].indicaciones}}
                    </ion-label>

                </ion-col>
            </ion-row>

        </ion-grid>
    </div>

    <div class="form-group required" *ngIf="currentTab === 'step3'">
        <h3 *ngIf="dataDespacho.tiempoEstimado && dataDespacho.estadoDespacho === 'camino'" class="eta-desp">
            Tiempo estimado: {{dataDespacho?.tiempoTransportista}}
        </h3>

        <h3 *ngIf="dataDespacho.estadoDespacho === 'preparado' || dataDespacho.estadoDespacho === 'preparadoTrans'" class="eta-desp">

        </h3>
        <div class="stepwizard">
            <div class="stepwizard-row">
                <div class="stepwizard-step">
                    <ion-icon *ngIf="dataDespacho.estadoDespacho === 'preparado' || dataDespacho.estadoDespacho === 'preparadoTrans' || dataDespacho.estadoDespacho === 'camino' || dataDespacho.estadoDespacho === 'entregado'" name="checkmark-circle-outline" class="icon-button">
                    </ion-icon>
                    <ion-icon *ngIf="dataDespacho.estadoDespacho === 'nuevo'" name="checkmark-circle-outline" class="icon-button1">
                    </ion-icon>
                    <ion-icon src="assets/imgs/svg/briefcase-outline.svg " class="bg-icon "></ion-icon>
                    <ion-label class="description">Preparado</ion-label>
                </div>

                <div class="stepwizard-step ">
                    <ion-icon *ngIf="dataDespacho.estadoDespacho === 'camino' || dataDespacho.estadoDespacho === 'entregado'" name="checkmark-circle-outline" class="icon-button">
                    </ion-icon>
                    <ion-icon *ngIf="dataDespacho.estadoDespacho != 'camino' && dataDespacho.estadoDespacho != 'entregado'" name="checkmark-circle-outline" class="icon-button1">
                    </ion-icon>

                    <ion-icon src="assets/imgs/svg/bicycle-outline.svg " class="bg-icon "></ion-icon>
                    <ion-label class="description">Camino</ion-label>
                </div>
                <div class="stepwizard-step ">
                    <ion-icon *ngIf="dataDespacho.estadoDespacho === 'entregado'" name="checkmark-circle-outline" class="icon-button"></ion-icon>
                    <ion-icon *ngIf="dataDespacho.estadoDespacho != 'entregado'" name="checkmark-circle-outline" class="icon-button1">
                    </ion-icon>
                    <ion-icon src="assets/imgs/svg/wallet-outline.svg " class="bg-icon "></ion-icon>
                    <ion-label class="description">Entregado</ion-label>
                </div>
            </div>
        </div>
    </div>
</ion-content>

<!-- <ion-footer>
    <ion-toolbar>

        <button *ngIf="dataReceta.estadoReceta=='nueva' " class="cerrar " (click)="goDetails(dataReceta) ">COMPRAR
            RECETA</button>

    </ion-toolbar>
</ion-footer> -->